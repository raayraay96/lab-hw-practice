<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECE362 HW5 Study Animations</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="navbar">
        <a href="../index.html">Home</a>
        <a href="../hw2/hw2.html">HW2</a>
        <a href="../hw3/hw3.html">HW3</a>
        <a href="../hw4/hw4.html">HW4</a>
        <a href="hw5.html">HW5</a>
        <a href="../hw6/hw6.html">HW6</a>
    </div>
    <h1>ECE362 HW5 Study Animations</h1>
    <div class="content">
        <div class="section" id="timer-section">
            <h2>Problem 1: Timer Configurations</h2>
            <div class="description">
                This problem asks you to find which timer settings produce a <strong>1 Hz</strong> square wave with a <strong>50% duty cycle</strong> (half on, half off) using a <span class="tooltip" data-tooltip="Prescaler: Divides the clock frequency to slow down the timer.">prescaler</span> of 999 and a 100 kHz clock. You’re given options with <strong>ARR</strong> (reload value) and <strong>CCR</strong> (compare value) in different modes (e.g., Toggle, PWM). The animation shows Option e (Count Up, PWM, ARR=99, CCR=50), where the timer counts to 99, resets, and the output is high when the counter is less than 50, giving 50% duty cycle at 1 Hz.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Counter</span>
                    <div class="signal-bits" id="timer-counter"></div>
                </div>
                <div class="signal-row">
                    <span class="signal-label">Output</span>
                    <div class="signal-bits" id="timer-output"></div>
                </div>
            </div>
            <div class="calculation-steps" id="timer-steps">
                <p>Timer Frequency = 100 kHz / (1+999) / (1+99) = 1 Hz</p>
                <p>Duty Cycle = CCR / (ARR+1) = 50 / 100 = 50%</p>
            </div>
            <div class="controls">
                <button id="timer-animate-btn">Animate</button>
                <button id="timer-steps-btn">Show Steps</button>
                <button id="timer-reset-btn">Reset</button>
            </div>
        </div>

        <div class="section" id="sinewave-section">
            <h2>Problem 5: Max Sinewave Frequency</h2>
            <div class="description">
                You’re using a <span class="tooltip" data-tooltip="Digital-to-Analog Converter: Turns digital values into analog signals.">DAC</span> to sample a sinewave table at <strong>500 kHz</strong>, and you need at least <strong>20 samples</strong> per wave to avoid distortion. This problem asks for the <strong>highest frequency</strong> you can produce without distortion. The animation simulates sampling a sinewave, showing how 20 samples fit into a 25 kHz cycle, calculated as 500,000 / 20 = 25,000 Hz.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Samples</span>
                    <div class="signal-bits" id="sinewave-samples"></div>
                </div>
            </div>
            <div class="calculation-steps" id="sinewave-steps">
                <p>DAC Rate = 500,000 samples/second</p>
                <p>Samples per Cycle = 20</p>
                <p>Max Frequency = 500,000 / 20 = 25,000 Hz</p>
            </div>
            <div class="controls">
                <button id="sinewave-animate-btn">Animate</button>
                <button id="sinewave-steps-btn">Show Steps</button>
                <button id="sinewave-reset-btn">Reset</button>
            </div>
        </div>

        <div class="section" id="center-section">
            <h2>Problem 9: Center-Aligned Timer</h2>
            <div class="description">
                This problem involves a <strong>center-aligned timer</strong> that counts up and down, forming a triangular waveform, with interrupts every <strong>10 ms</strong> at a <strong>100 kHz</strong> clock. You need to find the <strong>reload value (ARR)</strong>. Since it counts up to ARR and back down, one full cycle takes 2*ARR ticks, and the animation shows how ARR=500 fits the 10 ms interval (100,000 * 0.01 / 2 = 500).
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Counter</span>
                    <div class="signal-bits" id="center-counter"></div>
                </div>
            </div>
            <div class="calculation-steps" id="center-steps">
                <p>Cycles = 100 kHz * 10 ms = 1000</p>
                <p>ARR = Cycles / 2 = 1000 / 2 = 500</p>
            </div>
            <div class="controls">
                <button id="center-animate-btn">Animate</button>
                <button id="center-steps-btn">Show Steps</button>
                <button id="center-reset-btn">Reset</button>
            </div>
        </div>

        <div class="section" id="wavetable-section">
            <h2>Problem 8.1-8.3: Wavetable Step Calculations</h2>
            <div class="description">
                This problem demonstrates how a wavetable uses fractional steps to produce precise output frequencies. The animation shows how the <strong>step</strong> value (0x4f057) is calculated and how the offset wraps around after <strong>203</strong> iterations, with a visualization of the 16-bit shift operation.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Step</span>
                    <div class="signal-bits" id="wavetable-step"></div>
                </div>
                <div class="signal-row">
                    <span class="signal-label">Offset</span>
                    <div class="signal-bits" id="wavetable-offset"></div>
                </div>
            </div>
            <div class="calculation-steps" id="wavetable-steps">
                <p>Step = (493883 * 2^14) / 1000 = 0x4f057</p>
                <p>Offset increments by step each iteration</p>
                <p>Wraps after 203 iterations (0x2945f4)</p>
            </div>
            <div class="controls">
                <button id="wavetable-animate-btn">Animate</button>
                <button id="wavetable-steps-btn">Show Steps</button>
                <button id="wavetable-reset-btn">Reset</button>
            </div>
        </div>

        <div class="section" id="bjt-section">
            <h2>Problem 4: BJT Power Efficiency</h2>
            <div class="description">
                This problem demonstrates how a <strong>BJT transistor</strong> operates with a DAC signal. The animation shows the relationship between the <strong>DAC output</strong>, <strong>base current</strong>, and <strong>collector current</strong>, illustrating why slow-moving DAC signals are more power efficient.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">DAC</span>
                    <div class="signal-bits" id="dac-signal"></div>
                </div>
                <div class="signal-row">
                    <span class="signal-label">Current</span>
                    <div class="signal-bits" id="current-signal"></div>
                </div>
            </div>
            <div class="calculation-steps" id="bjt-steps">
                <p>BJT acts as a current-controlled current source</p>
                <p>Slow DAC changes = Less switching losses</p>
                <p>Power efficiency improved with gradual transitions</p>
            </div>
            <div class="controls">
                <button id="bjt-animate-btn">Animate</button>
                <button id="bjt-steps-btn">Show Steps</button>
                <button id="bjt-reset-btn">Reset</button>
            </div>
        </div>

        <div class="section" id="pwm-section">
            <h2>Problem 3: PWM Duty Cycle</h2>
            <div class="description">
                This problem explores PWM duty cycle calculation with a <strong>100kHz</strong> clock source, <strong>prescaler=999</strong>, and <strong>ARR=24</strong>. The animation demonstrates how the PWM signal is off for 24 cycles and on for 1 cycle, resulting in a <strong>4%</strong> duty cycle.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">PWM</span>
                    <div class="signal-bits" id="pwm-signal"></div>
                </div>
            </div>
            <div class="calculation-steps" id="pwm-steps">
                <p>Total Period = ARR + 1 = 25 cycles</p>
                <p>On Time = 1 cycle</p>
                <p>Duty Cycle = 1/25 = 4%</p>
            </div>
            <div class="controls">
                <button id="pwm-animate-btn">Animate</button>
                <button id="pwm-steps-btn">Show Steps</button>
                <button id="pwm-reset-btn">Reset</button>
            </div>
        </div>
    </div>
    <div id="back-to-top" onclick="scrollToTop()">↑</div>

    <script src="script.js"></script>
</body>
</html>