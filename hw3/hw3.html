<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECE362 HW3 Study Animations</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="navbar">
        <a href="../index.html">Home</a>
        <a href="../hw2/hw2.html">HW2</a>
        <a href="hw3.html">HW3</a>
        <a href="../hw4/hw4.html">HW4</a>
        <a href="../hw5/hw5.html">HW5</a>
        <a href="../hw6/hw6.html">HW6</a>
    </div>
    <h1>ECE362 HW3 Study Animations</h1>
    <div class="content">

        <!-- Problem 1: SysTick Limitations -->
        <div class="section" id="systick-limitations-section">
            <h2>Problem 1: SysTick Limitations</h2>
            <div class="description">
                Which cannot be implemented using SysTick? Animation explains why measuring <span class="tooltip" data-tooltip="Flash memory latency: Time taken to access data from flash memory.">flash memory latency</span> (option c) is problematic due to SysTick's granularity.
            </div>
            <div class="signal-container"  id="systick-limitations-container">
                <!-- Animation elements will be injected here by JavaScript -->
            </div>
            <div class="calculation-steps" id="systick-limitations-steps">
                <p>SysTick measures core clock periods.</p>
                <p><span class="step-highlight">Flash memory latency</span> is seen as 2 clock cycles by SysTick.</p>
                <p>Insufficient granularity for accurate latency measurement.</p>
            </div>
            <div class="controls">
                <button id="systick-limitations-animate-btn">Animate</button>
                <button id="systick-limitations-steps-btn">Show Steps</button>
                <button id="systick-limitations-reset-btn">Reset</button>
            </div>
        </div>

        <!-- Problem 2: Timer Prescaler and Reload Values -->
        <div class="section" id="timer-config-section">
            <h2>Problem 2: Timer Configuration for 1s Interval</h2>
            <div class="description">
                With a 100kHz clock, which <span class="tooltip" data-tooltip="Prescaler: Divides the clock frequency.">prescaler</span> and <span class="tooltip" data-tooltip="Reload: Value to reset the timer counter to.">reload</span> values give a 1s timer interval? Animation highlights the correct option using the formula.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Options</span>
                    <div class="signal-bits" id="timer-config-options">
                        <div>
                            <span class="bit low">PRE=100-1,<br>RELOAD=1000-1</span>
                            <span class="bit low">PRE=100000-1,<br>RELOAD=1-1</span>
                            <span class="bit low">PRE=10000-1,<br>RELOAD=10-1</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="calculation-steps" id="timer-config-steps">
                <p>Formula:  f<sub>timer update</sub> = f<sub>clock</sub> / ((1 + RELOAD) * (1 + PRESCALER))</p>
                <p>Option 1: (1 + 999) * (1 + 99) = 1000 * 100 = 100000. f<sub>timer update</sub> = 10<sup>5</sup> / 10<sup>5</sup> = <span class="step-highlight">1 Hz</span> (1s)</p>
                <p>Option 2: Reload=0 is invalid (timer blocked)</p>
                <p>Option 3: (1 + 9) * (1 + 9999) = 10 * 10000 = 100000. f<sub>timer update</sub> = 10<sup>5</sup> / 10<sup>5</sup> = <span class="step-highlight">1 Hz</span> (1s)</p>
            </div>
            <div class="controls">
                <button id="timer-config-animate-btn">Animate</button>
                <button id="timer-config-steps-btn">Show Steps</button>
                <button id="timer-config-reset-btn">Reset</button>
            </div>
        </div>

        <!-- Problem 3: Interrupt Interval Calculation -->
        <div class="section" id="interrupt-interval-section">
            <h2>Problem 3: Interrupt Interval with Prescaler and Reload</h2>
            <div class="description">
                100kHz clock, RELOAD=499, PRESCALER=0. What's the interrupt interval? Animation calculates and shows the interval.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Options</span>
                    <div class="signal-bits" id="interrupt-interval-options">
                        <div>
                            <span class="bit low">a) 2.5 ms</span>
                            <span class="bit low">b) 5 ms</span>
                            <span class="bit low">c) 10 ms</span>
                            <span class="bit low">d) 7 ms</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="calculation-steps" id="interrupt-interval-steps">
                <p>Formula:  f<sub>timer update</sub> = f<sub>clock</sub> / ((1 + RELOAD) * (1 + PRESCALER))</p>
                <p>f<sub>timer update</sub> = 10<sup>5</sup> Hz / ((1 + 499) * (1 + 0)) = 10<sup>5</sup> Hz / 500 = 200 Hz</p>
                <p>Interval = 1 / f<sub>timer update</sub> = 1 / 200 Hz = 0.005 s = <span class="step-highlight">5 ms</span></p>
            </div>
            <div class="controls">
                <button id="interrupt-interval-animate-btn">Animate</button>
                <button id="interrupt-interval-steps-btn">Show Steps</button>
                <button id="interrupt-interval-reset-btn">Reset</button>
            </div>
        </div>

        <!-- Problem 4: Keypad Scanning -->
        <div class="section" id="keypad-scanning-section">
            <h2>Problem 4: 4x4 Keypad Scanning</h2>
            <div class="description">
                4x4 keypad scanned using timer interrupts. Analyze key detection scenarios. Animation illustrates row-by-row scanning and key detection.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Keypad</span>
                    <div class="signal-bits" id="keypad-scanning-keypad">
                        <!-- Keypad visualization will be generated here -->
                    </div>
                </div>
            </div>
            <div class="calculation-steps" id="keypad-scanning-steps">
                <p>4.1: Keys 1 & 2 pressed - <span class="step-highlight">True</span> (same row, same ISR iteration)</p>
                <p>4.2: Keys 1 & 4 pressed - <span class="step-highlight">False</span> (different rows, different ISR iterations)</p>
                <p>4.3: Unstable bits before solid read - <span class="step-highlight">7 bits</span> (calculated based on bounce time and scan rate)</p>
            </div>
            <div class="controls">
                <button id="keypad-scanning-animate-btn">Animate</button>
                <button id="keypad-scanning-steps-btn">Show Steps</button>
                <button id="keypad-scanning-reset-btn">Reset</button>
            </div>
        </div>

        <!-- Problem 5: History Byte for Debouncing -->
        <div class="section" id="history-byte-section">
            <h2>Problem 5: History Byte for Key Debouncing</h2>
            <div class="description">
                Keypad debouncing using a history byte.  Analyze history byte values after button press and bouncing. Animation shows the history byte shifting and unstable bits.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">History Byte</span>
                    <div class="signal-bits" id="history-byte-options">
                        <div></div> <!-- Container for bits to be generated -->
                    </div>
                </div>
            </div>
            <div class="calculation-steps" id="history-byte-steps">
                <p>Scan every 1ms, bounce 14ms (4 scans).</p>
                <p>At t=25ms (7 scans), 7 bits in history.</p>
                <p>First unstable bit is 1, previous steady state 0.</p>
                <p>Possible values: <span class="step-highlight">01XXX111</span> (X=don't care)</p>
            </div>
            <div class="controls">
                <button id="history-byte-animate-btn">Animate</button>
                <button id="history-byte-steps-btn">Show Steps</button>
                <button id="history-byte-reset-btn">Reset</button>
            </div>
        </div>

        <!-- Problem 6: 8-Segment Display Minimum Frequency -->
        <div class="section" id="display-frequency-section">
            <h2>Problem 6: Minimum Frequency for 8-Segment Displays</h2>
            <div class="description">
                8-segment displays can be off for 80ms without flicker. Find minimum switching frequency for 50 displays. Animation calculates and shows frequency.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Frequency</span>
                    <div class="signal-bits" id="display-frequency-options">
                        <div></div> <!-- Container for bits to be generated -->
                        <span class="bit">Hz</span>
                    </div>
                </div>
            </div>
            <div class="calculation-steps" id="display-frequency-steps">
                <p>Total off time: 80 ms.</p>
                <p>Time per display: 80 ms / 50 displays = 1.6 ms/display</p>
                <p>Minimum frequency = 1 / 1.6 ms = <span class="step-highlight">625 Hz</span></p>
            </div>
            <div class="controls">
                <button id="display-frequency-animate-btn">Animate</button>
                <button id="display-frequency-steps-btn">Show Steps</button>
                <button id="display-frequency-reset-btn">Reset</button>
            </div>
        </div>

        <!-- Problem 7: Multiplexing 8-Segment Displays - Pins -->
        <div class="section" id="multiplexing-pins-section">
            <h2>Problem 7: Microcontroller Pins for Multiplexing Displays</h2>
            <div class="description">
                Minimum pins to drive fifty 8-segment displays using multiplexing. Animation illustrates pin calculation based on display count.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Pins Needed</span>
                    <div class="signal-bits" id="multiplexing-pins-options">
                        <div></div> <!-- Container for bits to be generated -->
                        <span class="bit">pins</span>
                    </div>
                </div>
            </div>
            <div class="calculation-steps" id="multiplexing-pins-steps">
                <p>Pins = log<sub>2</sub>(n) + 8, where n = number of displays.</p>
                <p>Pins = log<sub>2</sub>(50) + 8 ≈ 5.64 + 8 ≈ 13.64</p>
                <p>Round up to nearest integer: <span class="step-highlight">14 pins</span></p>
            </div>
            <div class="controls">
                <button id="multiplexing-pins-animate-btn">Animate</button>
                <button id="multiplexing-pins-steps-btn">Show Steps</button>
                <button id="multiplexing-pins-reset-btn">Reset</button>
            </div>
        </div>

        <!-- Problem 8: Multiplexing Two Arrays -->
        <div class="section" id="two-arrays-section">
            <h2>Problem 8: Pins for Two Identical Display Arrays</h2>
            <div class="description">
                Pins needed for two arrays of fifty 8-segment displays each, showing identical information. Animation explains why pin count remains the same as problem 7.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Pins Needed</span>
                    <div class="signal-bits" id="two-arrays-options">
                        <div></div> <!-- Container for bits to be generated -->
                        <span class="bit">pins</span>
                    </div>
                </div>
            </div>
            <div class="calculation-steps" id="two-arrays-steps">
                <p>Displaying identical information means <span class="step-highlight">same addressing logic</span>.</p>
                <p>Tie the second array in parallel to the first.</p>
                <p>No additional pins needed. Still <span class="step-highlight">14 pins</span>.</p>
            </div>
            <div class="controls">
                <button id="two-arrays-animate-btn">Animate</button>
                <button id="two-arrays-steps-btn">Show Steps</button>
                <button id="two-arrays-reset-btn">Reset</button>
            </div>
        </div>

        <!-- Problem 9: 8-bit Counter Timer Interval -->
        <div class="section" id="counter-timer-section">
            <h2>Problem 9: 8-bit Counter Timer Interval</h2>
            <div class="description">
                8-bit counter timer, 100kHz clock, sawtooth waveform. Find maximum interval (x in ms). Animation calculates interval based on prescaler and counter size.
            </div>
            <div class="signal-container">
                <div class="signal-row">
                    <span class="signal-label">Interval (x)</span>
                    <div class="signal-bits" id="counter-timer-options">
                        <div></div> <!-- Container for bits to be generated -->
                        <span class="bit">ms</span>
                    </div>
                </div>
            </div>
            <div class="calculation-steps" id="counter-timer-steps">
                <p>Prescaler = 2-1 = 1 (increments every 2nd clock edge).</p>
                <p>8-bit counter, max values = 2<sup>8</sup> = 256, RELOAD = 256 - 1 = 255.</p>
                <p>f<sub>timer update</sub> = 10<sup>5</sup> Hz / ((1 + 255) * (1 + 1)) = 10<sup>5</sup> Hz / 512 ≈ 195.3 Hz</p>
                <p>Interval = 1 / 195.3 Hz ≈ 0.00512 s = <span class="step-highlight">5.12 ms</span></p>
            </div>
            <div class="controls">
                <button id="counter-timer-animate-btn">Animate</button>
                <button id="counter-timer-steps-btn">Show Steps</button>
                <button id="counter-timer-reset-btn">Reset</button>
            </div>
        </div>


    </div>
    <div id="back-to-top" onclick="scrollToTop()">↑</div>
    <div id="explanation-overlay">
        <div id="explanation-message"></div>
    </div>

    <script src="script.js"></script>
</body>
</html>